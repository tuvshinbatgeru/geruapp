["6930fe4dac5e0db85826fe3a5a7d85e46171556e","4baa78007c0ddc729d6d0c7bdef0155dcaaaadf4",["./class"],[20],{"version":3,"sources":["/var/www/geruapp/node_modules/art/core/transform.js"],"names":["Class","require","Transform","xx","yx","xy","yy","x","y","_transform","module","exports","initialize","transform","m","transformTo","translate","move","scale","rotate","deg","left","width","top","height","rad","Math","PI","sin","cos","moveTo","rotateTo","flip","atan2","scaleTo","h","sqrt","resizeTo","w","inversePoint","a","b","c","d","e","f","det","point"],"mappings":"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","sourcesContent":["var Class = require('./class');\n\nfunction Transform(xx, yx, xy, yy, x, y){\n\tif (xx && typeof xx == 'object'){\n\t\tyx = xx.yx; yy = xx.yy; y = xx.y;\n\t\txy = xx.xy; x = xx.x; xx = xx.xx;\n\t}\n\tthis.xx = xx == null ? 1 : xx;\n\tthis.yx = yx || 0;\n\tthis.xy = xy || 0;\n\tthis.yy = yy == null ? 1 : yy;\n\tthis.x = (x == null ? this.x : x) || 0;\n\tthis.y = (y == null ? this.y : y) || 0;\n\tthis._transform();\n\treturn this;\n};\n\nmodule.exports = Class({\n\n\tinitialize: Transform,\n\n\t_transform: function(){},\n\n\txx: 1, yx: 0, x: 0,\n\txy: 0, yy: 1, y: 0,\n\n\ttransform: function(xx, yx, xy, yy, x, y){\n\t\tvar m = this;\n\t\tif (xx && typeof xx == 'object'){\n\t\t\tyx = xx.yx; yy = xx.yy; y = xx.y;\n\t\t\txy = xx.xy; x = xx.x; xx = xx.xx;\n\t\t}\n\t\tif (!x) x = 0;\n\t\tif (!y) y = 0;\n\t\treturn this.transformTo(\n\t\t\tm.xx * xx + m.xy * yx,\n\t\t\tm.yx * xx + m.yy * yx,\n\t\t\tm.xx * xy + m.xy * yy,\n\t\t\tm.yx * xy + m.yy * yy,\n\t\t\tm.xx * x + m.xy * y + m.x,\n\t\t\tm.yx * x + m.yy * y + m.y\n\t\t);\n\t},\n\n\ttransformTo: Transform,\n\n\ttranslate: function(x, y){\n\t\treturn this.transform(1, 0, 0, 1, x, y);\n\t},\n\n\tmove: function(x, y){\n\t\tthis.x += x || 0;\n\t\tthis.y += y || 0;\n\t\tthis._transform();\n\t\treturn this;\n\t},\n\n\tscale: function(x, y){\n\t\tif (y == null) y = x;\n\t\treturn this.transform(x, 0, 0, y, 0, 0);\n\t},\n\n\trotate: function(deg, x, y){\n\t\tif (x == null || y == null){\n\t\t\tx = (this.left || 0) + (this.width || 0) / 2;\n\t\t\ty = (this.top || 0) + (this.height || 0) / 2;\n\t\t}\n\n\t\tvar rad = deg * Math.PI / 180, sin = Math.sin(rad), cos = Math.cos(rad);\n\n\t\tthis.transform(1, 0, 0, 1, x, y);\n\t\tvar m = this;\n\n\t\treturn this.transformTo(\n\t\t\tcos * m.xx - sin * m.yx,\n\t\t\tsin * m.xx + cos * m.yx,\n\t\t\tcos * m.xy - sin * m.yy,\n\t\t\tsin * m.xy + cos * m.yy,\n\t\t\tm.x,\n\t\t\tm.y\n\t\t).transform(1, 0, 0, 1, -x, -y);\n\t},\n\n\tmoveTo: function(x, y){\n\t\tvar m = this;\n\t\treturn this.transformTo(m.xx, m.yx, m.xy, m.yy, x, y);\n\t},\n\n\trotateTo: function(deg, x, y){\n\t\tvar m = this;\n\t\tvar flip = m.yx / m.xx > m.yy / m.xy ? -1 : 1;\n\t\tif (m.xx < 0 ? m.xy >= 0 : m.xy < 0) flip = -flip;\n\t\treturn this.rotate(deg - Math.atan2(flip * m.yx, flip * m.xx) * 180 / Math.PI, x, y);\n\t},\n\n\tscaleTo: function(x, y){\n\t\t// Normalize\n\t\tvar m = this;\n\n\t\tvar h = Math.sqrt(m.xx * m.xx + m.yx * m.yx);\n\t\tm.xx /= h; m.yx /= h;\n\n\t\th = Math.sqrt(m.yy * m.yy + m.xy * m.xy);\n\t\tm.yy /= h; m.xy /= h;\n\n\t\treturn this.scale(x, y);\n\t},\n\n\tresizeTo: function(width, height){\n\t\tvar w = this.width, h = this.height;\n\t\tif (!w || !h) return this;\n\t\treturn this.scaleTo(width / w, height / h);\n\t},\n\n\t/*\n\tinverse: function(){\n\t\tvar a = this.xx, b = this.yx,\n\t\t\tc = this.xy, d = this.yy,\n\t\t\te = this.x, f = this.y;\n\t\tif (a * d - b * c == 0) return null;\n\t\treturn new Transform(\n\t\t\td/(a * d-b * c), b/(b * c-a * d),\n\t\t\tc/(b * c-a * d), a/(a * d-b * c),\n\t\t\t(d * e-c * f)/(b * c-a * d), (b * e-a * f)/(a * d-b * c)\n\t\t);\n\t},\n\t*/\n\n\tinversePoint: function(x, y){\n\t\tvar a = this.xx, b = this.yx,\n\t\t\tc = this.xy, d = this.yy,\n\t\t\te = this.x, f = this.y;\n\t\tvar det = b * c - a * d;\n\t\tif (det == 0) return null;\n\t\treturn {\n\t\t\tx: (d * (e - x) + c * (y - f)) / det,\n\t\t\ty: (a * (f - y) + b * (x - e)) / det\n\t\t};\n\t},\n\n\tpoint: function(x, y){\n\t\tvar m = this;\n\t\treturn {\n\t\t\tx: m.xx * x + m.xy * y + m.x,\n\t\t\ty: m.yx * x + m.yy * y + m.y\n\t\t};\n\t}\t\n\n});\n"]}]