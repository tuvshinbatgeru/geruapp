["dfeecb637572a2d5dd0ca020f5b371f409bd49a2","87b8ed5412424ad3e83a1e8c8ceea55f015ddf15",["./commons","./custom-event-target","./event-wrapper"],[39,85,138],{"version":3,"sources":["/var/www/geruapp/node_modules/event-target-shim/lib/event-target.js"],"names":["Commons","require","CustomEventTarget","EventWrapper","LISTENERS","CAPTURE","BUBBLE","ATTRIBUTE","newNode","defineCustomEventTarget","createEventWrapper","STOP_IMMEDIATE_PROPAGATION_FLAG","HAS_EVENTTARGET_INTERFACE","window","EventTarget","module","exports","Object","defineProperty","value","create","arguments","length","Array","isArray","types","i","TypeError","prototype","constructor","writable","configurable","addEventListener","type","listener","capture","kind","node","prev","next","removeEventListener","dispatchEvent","event","wrapped","call","handleEvent","defaultPrevented"],"mappings":"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","sourcesContent":["/**\n * @author Toru Nagashima\n * @copyright 2015 Toru Nagashima. All rights reserved.\n * See LICENSE file in root directory for full license.\n */\n\n\"use strict\";\n\n//-----------------------------------------------------------------------------\n// Requirements\n//-----------------------------------------------------------------------------\n\nvar Commons = require(\"./commons\");\nvar CustomEventTarget = require(\"./custom-event-target\");\nvar EventWrapper = require(\"./event-wrapper\");\nvar LISTENERS = Commons.LISTENERS;\nvar CAPTURE = Commons.CAPTURE;\nvar BUBBLE = Commons.BUBBLE;\nvar ATTRIBUTE = Commons.ATTRIBUTE;\nvar newNode = Commons.newNode;\nvar defineCustomEventTarget = CustomEventTarget.defineCustomEventTarget;\nvar createEventWrapper = EventWrapper.createEventWrapper;\nvar STOP_IMMEDIATE_PROPAGATION_FLAG =\n    EventWrapper.STOP_IMMEDIATE_PROPAGATION_FLAG;\n\n//-----------------------------------------------------------------------------\n// Constants\n//-----------------------------------------------------------------------------\n\n/**\n * A flag which shows there is the native `EventTarget` interface object.\n *\n * @type {boolean}\n * @private\n */\nvar HAS_EVENTTARGET_INTERFACE = (\n    typeof window !== \"undefined\" &&\n    typeof window.EventTarget !== \"undefined\"\n);\n\n//-----------------------------------------------------------------------------\n// Public Interface\n//-----------------------------------------------------------------------------\n\n/**\n * An implementation for `EventTarget` interface.\n *\n * @constructor\n * @public\n */\nvar EventTarget = module.exports = function EventTarget() {\n    if (this instanceof EventTarget) {\n        // this[LISTENERS] is a Map.\n        // Its key is event type.\n        // Its value is ListenerNode object or null.\n        //\n        // interface ListenerNode {\n        //     var listener: Function\n        //     var kind: CAPTURE|BUBBLE|ATTRIBUTE\n        //     var next: ListenerNode|null\n        // }\n        Object.defineProperty(this, LISTENERS, {value: Object.create(null)});\n    }\n    else if (arguments.length === 1 && Array.isArray(arguments[0])) {\n        return defineCustomEventTarget(EventTarget, arguments[0]);\n    }\n    else if (arguments.length > 0) {\n        var types = Array(arguments.length);\n        for (var i = 0; i < arguments.length; ++i) {\n            types[i] = arguments[i];\n        }\n\n        // To use to extend with attribute listener properties.\n        // e.g.\n        //     class MyCustomObject extends EventTarget(\"message\", \"error\") {\n        //         //...\n        //     }\n        return defineCustomEventTarget(EventTarget, types);\n    }\n    else {\n        throw new TypeError(\"Cannot call a class as a function\");\n    }\n};\n\nEventTarget.prototype = Object.create(\n    (HAS_EVENTTARGET_INTERFACE ? window.EventTarget : Object).prototype,\n    {\n        constructor: {\n            value: EventTarget,\n            writable: true,\n            configurable: true\n        },\n\n        addEventListener: {\n            value: function addEventListener(type, listener, capture) {\n                if (listener == null) {\n                    return false;\n                }\n                if (typeof listener !== \"function\" && typeof listener !== \"object\") {\n                    throw new TypeError(\"\\\"listener\\\" is not an object.\");\n                }\n\n                var kind = (capture ? CAPTURE : BUBBLE);\n                var node = this[LISTENERS][type];\n                if (node == null) {\n                    this[LISTENERS][type] = newNode(listener, kind);\n                    return true;\n                }\n\n                var prev = null;\n                while (node != null) {\n                    if (node.listener === listener && node.kind === kind) {\n                        // Should ignore a duplicated listener.\n                        return false;\n                    }\n                    prev = node;\n                    node = node.next;\n                }\n\n                prev.next = newNode(listener, kind);\n                return true;\n            },\n            configurable: true,\n            writable: true\n        },\n\n        removeEventListener: {\n            value: function removeEventListener(type, listener, capture) {\n                if (listener == null) {\n                    return false;\n                }\n\n                var kind = (capture ? CAPTURE : BUBBLE);\n                var prev = null;\n                var node = this[LISTENERS][type];\n                while (node != null) {\n                    if (node.listener === listener && node.kind === kind) {\n                        if (prev == null) {\n                            this[LISTENERS][type] = node.next;\n                        }\n                        else {\n                            prev.next = node.next;\n                        }\n                        return true;\n                    }\n\n                    prev = node;\n                    node = node.next;\n                }\n\n                return false;\n            },\n            configurable: true,\n            writable: true\n        },\n\n        dispatchEvent: {\n            value: function dispatchEvent(event) {\n                // If listeners aren't registered, terminate.\n                var node = this[LISTENERS][event.type];\n                if (node == null) {\n                    return true;\n                }\n\n                // Since we cannot rewrite several properties, so wrap object.\n                var wrapped = createEventWrapper(event, this);\n\n                // This doesn't process capturing phase and bubbling phase.\n                // This isn't participating in a tree.\n                while (node != null) {\n                    if (typeof node.listener === \"function\") {\n                        node.listener.call(this, wrapped);\n                    }\n                    else if (node.kind !== ATTRIBUTE && typeof node.listener.handleEvent === \"function\") {\n                        node.listener.handleEvent(wrapped);\n                    }\n\n                    if (wrapped[STOP_IMMEDIATE_PROPAGATION_FLAG]) {\n                        break;\n                    }\n                    node = node.next;\n                }\n\n                return !wrapped.defaultPrevented;\n            },\n            configurable: true,\n            writable: true\n        }\n    }\n);\n"]}]